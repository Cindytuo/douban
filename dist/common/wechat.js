"use strict";var face=require("./face"),Promise=require("../util/es6-promise.min").Promise,extendPromise=function(n){n.success=function(e){return n.then(function(n){e(n)}),n},n.fail=function(e){return n.then(null,function(n){e(n)}),n}},login=function(){var n=new Promise(function(n,e){wx.login({success:function(e){n(e)},fail:function(n){e(n)}})});return extendPromise(n),n},loginGetOpenId=function(){var n=function(){var n=new Promise(function(n,e){wx.login({success:function(e){n(e)},fail:function(n){e(n)}})});return n},e=function(n){var e=new Promise(function(e,o){wx.request({url:"localhost:3000/wechat",data:n.code,success:function(n){e(n)},fail:function(n){o(n)}})});return e};return n().then(function(n){return extendPromise(e(n.code)),e(n.code)},function(e){return extendPromise(n()),null})},getUserInfo=function(){var n=new Promise(function(n,e){wx.getUserInfo({success:function(e){e.userInfo;n(e)},fail:function(n){e(n)}})});return extendPromise(n),n},getLocation=function(){var n=new Promise(function(n,e){wx.getLocation({type:"wgs84",success:function(e){n(e)},fail:function(n){e(n)}})});return extendPromise(n),n},scanCode=function(){var n=new Promise(function(n,e){wx.scanCode({success:function(e){n(e)},fail:function(n){e(n)}})});return extendPromise(n),n};module.exports={login:login,loginGetOpenId:loginGetOpenId,getUserInfo:getUserInfo,getLocation:getLocation,scanCode:scanCode};